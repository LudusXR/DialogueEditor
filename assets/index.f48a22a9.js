var fe=Object.defineProperty,ve=Object.defineProperties;var ge=Object.getOwnPropertyDescriptors;var oe=Object.getOwnPropertySymbols;var ye=Object.prototype.hasOwnProperty,me=Object.prototype.propertyIsEnumerable;var ne=(e,t,s)=>t in e?fe(e,t,{enumerable:!0,configurable:!0,writable:!0,value:s}):e[t]=s,P=(e,t)=>{for(var s in t||(t={}))ye.call(t,s)&&ne(e,s,t[s]);if(oe)for(var s of oe(t))me.call(t,s)&&ne(e,s,t[s]);return e},H=(e,t)=>ve(e,ge(t));import{d as L,u as xe,R as Ne,D as M,o as r,c as d,a as o,b as re,F as Ce,r as E,e as $e,f as x,w as de,g as F,h as R,n as be,i as h,t as Y,j as b,k as le,v as ae,p as W,l as X,C as O,m as Q,q as ie,s as ke,L as Se,z as we,x as De}from"./vendor.20ede4ff.js";const Te=function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const n of document.querySelectorAll('link[rel="modulepreload"]'))i(n);new MutationObserver(n=>{for(const u of n)if(u.type==="childList")for(const v of u.addedNodes)v.tagName==="LINK"&&v.rel==="modulepreload"&&i(v)}).observe(document,{childList:!0,subtree:!0});function s(n){const u={};return n.integrity&&(u.integrity=n.integrity),n.referrerpolicy&&(u.referrerPolicy=n.referrerpolicy),n.crossorigin==="use-credentials"?u.credentials="include":n.crossorigin==="anonymous"?u.credentials="omit":u.credentials="same-origin",u}function i(n){if(n.ep)return;n.ep=!0;const u=s(n);fetch(n.href,u)}};Te();class Ie{constructor(t,s,i,n){this.name=t,this.playerType=s,this.texts=i,this.fullfilsQuest=n}}class Ae{constructor(t,s){this.x=t,this.y=s}}class Pe{constructor(t,s,i,n,u){this.id=t,this.position=s,this.type=i,this.class=n,this.data=u}}class He{constructor(t,s,i,n,u){this.id=t,this.source=s,this.target=i,this.sourceHandle=n,this.targetHandle=u}}class ce{}var j=(e,t)=>{const s=e.__vccOpts||e;for(const[i,n]of t)s[i]=n;return s};const Ee={class:"save__controls"},Fe={class:"btn"},Le=re(" Load scenario "),qe={inheritAttrs:!1,methods:{onFileChange(e){let t=e.target.files;t==null||!t.length||this.doSomethingWithTheFile(t[0])},onSave(){let e=prompt("Define your file name.");if(this.$props.scenario!=null){var t=new Blob([JSON.stringify(this.$props.scenario)],{type:"application/json"});Ce.exports.saveAs(t,e)}},doSomethingWithTheFile(e){let t=new FileReader;t.onload=s=>{if(s.target!=null){let i=JSON.parse(String(s.target.result));console.log(i),this.$emit("json-file-loaded",i)}},t.readAsText(e)}},props:{scenario:ce}},Ve=L(H(P({},qe),{setup(e){return xe("example-flow",{nodes:[],edges:[],position:[NaN,NaN],zoom:1}),Ne(),M(),(s,i)=>(r(),d("div",Ee,[o("label",{class:"btn",onClick:i[0]||(i[0]=(...n)=>s.onSave&&s.onSave(...n))},"Save scenario"),o("label",Fe,[o("input",{id:"hiddenInput",type:"file",onChange:i[1]||(i[1]=(...n)=>s.onFileChange&&s.onFileChange(...n))},null,32),Le])]))}}));var Re=j(Ve,[["__scopeId","data-v-22554318"]]);const N=e=>(W("data-v-45df8e7e"),e=e(),X(),e),Oe={class:"hidemenu"},Qe={key:0},Be=N(()=>o("div",{class:"description"},"Here you can select the dialogs from this scenario",-1)),je=N(()=>o("hr",null,null,-1)),ze=["onClick"],Ue={key:1},Je=N(()=>o("div",{class:"description"},"Here you can see and edit the quests for the scenario",-1)),Ke=N(()=>o("hr",null,null,-1)),Ye=["onUpdate:modelValue"],Me={key:2},We=N(()=>o("div",{class:"description"},"Here you can see and edit the briefing for the scenario",-1)),Xe=N(()=>o("hr",null,null,-1)),Ge={class:"sidemenu"},Ze={key:0},et=N(()=>o("div",{class:"description"},"You can drag these nodes to the pane.",-1)),tt=N(()=>o("hr",null,null,-1)),st=N(()=>o("div",{class:"description"},"Player Nodes",-1)),ot=N(()=>o("hr",null,null,-1)),nt=N(()=>o("div",{class:"description"},"NPC Nodes",-1)),lt=["onDragstart"],at=L({props:{scenario:ce},emits:["dialogSelected"],setup(e,{expose:t,emit:s}){const i=e,{nodes:n,edges:u,addNodes:v,setNodes:y,setEdges:S,instance:w,dimensions:m}=M(),C=(f,p,V,l)=>{f.dataTransfer&&(f.dataTransfer.setData("application/vueflow",p),f.dataTransfer.setData("application/nodeClass",V),f.dataTransfer.setData("application/npcName",l),f.dataTransfer.effectAllowed="move")};let q=null,D=E(null);E(null),t({reset:()=>{q=null,D.value=null,y([]),S([])}});const U=(f,p)=>{console.log(D),q=f,D.value=p,s("dialogSelected",p),y(f.nodes),S(f.edges)},_=()=>{var f;if(q!=null){let p=prompt("Please enter the new NPC name","");(f=q.actors)==null||f.push(p)}},J=()=>{i.scenario!=null&&i.scenario.quests.push("")};return(f,p)=>{const V=$e("container");return r(),d(F,null,[o("div",Oe,[x(V,null,{default:de(()=>[e.scenario!=null?(r(),d("aside",Qe,[Be,je,(r(!0),d(F,null,R(e.scenario.conversations,(l,g)=>(r(),d("div",{key:g,class:be(["vue-flow__node-default",{active:g===h(D)}]),onClick:I=>U(l,g)}," Dialog "+Y(g),11,ze))),128))])):b("",!0),e.scenario!=null?(r(),d("aside",Ue,[Je,Ke,(r(!0),d(F,null,R(e.scenario.quests,(l,g)=>(r(),d("div",{key:g},[le(o("textarea",{name:"quest","onUpdate:modelValue":I=>e.scenario.quests[g]=I,rows:""},null,8,Ye),[[ae,e.scenario.quests[g]]])]))),128)),o("button",{onClick:J},"Add Quest")])):b("",!0),e.scenario!=null?(r(),d("aside",Me,[We,Xe,le(o("textarea",{name:"briefing",id:"briefing","onUpdate:modelValue":p[0]||(p[0]=l=>e.scenario.briefing=l),rows:"10"},null,512),[[ae,e.scenario.briefing]])])):b("",!0)]),_:1})]),o("div",Ge,[h(D)!=null?(r(),d("aside",Ze,[et,tt,st,o("div",{class:"vue-flow__node-default player1",draggable:!0,onDragstart:p[1]||(p[1]=l=>C(l,"playerNode","player1"))}," Player1 Node ",32),o("div",{class:"vue-flow__node-default player2",draggable:!0,onDragstart:p[2]||(p[2]=l=>C(l,"playerNode","player2"))}," Player2 Node ",32),o("div",{class:"vue-flow__node-default playerAll",draggable:!0,onDragstart:p[3]||(p[3]=l=>C(l,"playerNode","playerAll"))}," All Players Node ",32),ot,nt,(r(!0),d(F,null,R(e.scenario.conversations[h(D)].actors,(l,g)=>(r(),d("div",{key:g,class:"vue-flow__node-default npc",draggable:!0,onDragstart:I=>C(I,"npcNode","npc",l)},Y(l),41,lt))),128)),o("button",{onClick:_},"Add NPC")])):b("",!0)])],64)}}});var it=j(at,[["__scopeId","data-v-45df8e7e"]]);const G=e=>(W("data-v-647cd1d8"),e=e(),X(),e),rt={style:{position:"relative"}},dt=re(" NPC - "),ct=G(()=>o("hr",null,null,-1)),ut=G(()=>o("div",null," Responses: ",-1)),pt={id:"texts-npcs"},_t=["value","onInput"],ht=["onClick"],ft=G(()=>o("br",null,null,-1)),vt={key:0,class:"footer"},gt={inheritAttrs:!1,mounted(){document.querySelectorAll("textarea").forEach(e=>{e.style.height="",e.style.height=e.scrollHeight+"px"})}},yt=L(H(P({},gt),{props:{id:null,data:null},setup(e){const t=e,s={background:"#555",position:"absolute",top:"20px"};H(P({},s),{position:"relative",left:"15px",top:"0px",transform:"0"});const i=()=>{t.data.texts.push("")},n=(v,y)=>{t.data.texts[y]=v.target.value},u=v=>{t.data.texts.splice(v,1)};return(v,y)=>(r(),d("div",rt,[x(h(Q),{type:"target",id:"gi1",position:h(O).Left,style:s,"on-connect":t.data.onConnect},null,8,["position","on-connect"]),x(h(Q),{type:"source",id:"go1",position:h(O).Right,style:s,"on-connect":t.data.onConnect},null,8,["position","on-connect"]),o("div",null,[dt,o("strong",null,Y(e.data.name),1)]),ct,ut,o("ul",pt,[(r(!0),d(F,null,R(e.data.texts,(S,w)=>(r(),d("li",{key:w,style:{position:"relative"}},[o("textarea",{class:"nodrag",value:e.data.texts[w],onInput:m=>n(m,w),oninput:'this.style.height = "";this.style.height = this.scrollHeight + "px"'},null,40,_t),o("span",{onClick:m=>u(w)},"x",8,ht)]))),128))]),ft,o("button",{onClick:i},"Add text"),t.data.fullfilsQuest?(r(),d("div",vt,"Fullfils Quest")):b("",!0)]))}}));var mt=j(yt,[["__scopeId","data-v-647cd1d8"]]);const Z=e=>(W("data-v-3fbe38b4"),e=e(),X(),e),xt={style:{position:"relative"}},Nt={key:0},Ct={key:1},$t={key:2},bt=Z(()=>o("hr",null,null,-1)),kt=Z(()=>o("div",null," Responses: ",-1)),St={id:"texts-npcs"},wt=["value","onInput"],Dt=["onClick"],Tt=Z(()=>o("br",null,null,-1)),It={key:0,class:"footer"},At={inheritAttrs:!1,mounted(){document.querySelectorAll("textarea").forEach(e=>{e.style.height="",e.style.height=e.scrollHeight+"px"})}},Pt=L(H(P({},At),{props:{id:null,data:null},setup(e){const t=e,s={background:"#555",position:"absolute",top:"20px"},i=H(P({},s),{position:"relative",left:"15px",top:"0px",transform:"0"}),n=()=>{t.data.texts.push("")},u=(y,S)=>{t.data.texts[S]=y.target.value},v=y=>{t.data.texts.splice(y,1)};return(y,S)=>(r(),d("div",xt,[x(h(Q),{type:"target",id:"gi1",position:h(O).Left,style:s,"on-connect":t.data.onConnect},null,8,["position","on-connect"]),x(h(Q),{type:"source",id:"go1",position:h(O).Right,style:s,"on-connect":t.data.onConnect},null,8,["position","on-connect"]),o("div",null,[t.data.playerType=="player1"?(r(),d("strong",Nt,"Player 1")):b("",!0),t.data.playerType=="player2"?(r(),d("strong",Ct,"Player 2")):b("",!0),t.data.playerType=="playerAll"?(r(),d("strong",$t,"All Players")):b("",!0)]),bt,kt,o("ul",St,[(r(!0),d(F,null,R(e.data.texts,(w,m)=>(r(),d("li",{key:m,style:{position:"relative"}},[o("textarea",{class:"nodrag",value:e.data.texts[m],onInput:C=>u(C,m),oninput:'this.style.height = "";this.style.height = this.scrollHeight + "px"'},null,40,wt),x(h(Q),{id:"p"+m,type:"source",position:h(O).Right,style:i},null,8,["id","position"]),o("span",{onClick:C=>v(m)},"x",8,Dt)]))),128))]),Tt,o("button",{onClick:n},"Add response"),t.data.fullfilsQuest?(r(),d("div",It,"Fullfils Quest")):b("",!0)]))}}));var Ht=j(Pt,[["__scopeId","data-v-3fbe38b4"]]);const Et=L({setup(e){const t=[],{instance:s,onConnect:i,nodes:n,edges:u,addEdges:v,addNodes:y,setNodes:S,setEdges:w,onEdgesChange:m,onNodesChange:C,setTranslateExtent:q,setState:D}=M();let z=0;const U=()=>`node${z++}`;let _=E(null);C(a=>{console.log(a),a.forEach(c=>{var $,T;if(l.value!=null&&_.value!=null){if(c.type==="position"){let k=l.value.conversations[_.value].nodes.findIndex(function(A){return A.id==c.id});k>=0&&(l.value.conversations[_.value].nodes[k].position.x=($=c.position)==null?void 0:$.x,l.value.conversations[_.value].nodes[k].position.y=(T=c.position)==null?void 0:T.y)}else if(c.type==="remove"){let k=l.value.conversations[_.value].nodes.findIndex(function(A){return A.id==c.id});l.value.conversations[_.value].nodes.splice(k,1)}}})}),m(a=>{a.forEach(c=>{if(c.type==="remove"&&l.value!=null&&_.value!=null){let $=l.value.conversations[_.value].edges.findIndex(function(T){return T.id==c.id});l.value.conversations[_.value].edges.splice($,1)}})}),i(a=>{if(v([a]),l.value!=null&&_.value!=null){let c="edge-"+a.source+a.sourceHandle+"-"+a.target+a.targetHandle;l.value.conversations[_.value].edges.push(new He(c,a.source,a.target,a.sourceHandle,a.targetHandle))}});const J=a=>{a.preventDefault(),a.dataTransfer&&(a.dataTransfer.dropEffect="move")},f=a=>{},p=a=>{var c,$,T,k;if(s.value){const A=U(),te=[],K=(c=a.dataTransfer)==null?void 0:c.getData("application/vueflow"),B=($=a.dataTransfer)==null?void 0:$.getData("application/nodeClass"),se=(T=a.dataTransfer)==null?void 0:T.getData("application/npcName"),pe=s.value.project({x:a.clientX,y:a.clientY-40}),_e={id:A,type:K,class:B,data:{onChange:f,onConnect:i,name:se,texts:te,playerType:B,fullfilsQuest:!1},connectable:!0,position:pe,label:`${K} node`};y([_e]);let he=new Pe(A,new Ae(a.clientX,a.clientY-40),K,B,new Ie(se,B,te,!1));(k=l.value)==null||k.conversations[_.value].nodes.push(he)}},V={npcNode:ie(mt),playerNode:ie(Ht)},l=E(null),g=E(null),I=a=>{var c;l.value=null,l.value=a,_.value=null,(c=g.value)==null||c.reset()},ue=a=>{var c;_.value=a,z=Number((c=l.value)==null?void 0:c.conversations[a].nodes.length)+1},ee=E(t);return(a,c)=>(r(),d("div",{class:"dndflow",onDrop:p},[x(h(ke),{modelValue:ee.value,"onUpdate:modelValue":c[0]||(c[0]=$=>ee.value=$),onDragover:J,"node-types":V},{default:de(()=>[x(h(Se),{variant:h(we).Lines,"pattern-color":"#4d4d4d",gap:"25"},null,8,["variant"]),x(Re,{scenario:l.value,onJsonFileLoaded:I},null,8,["scenario"]),x(it,{scenario:l.value,onDialogSelected:ue,ref_key:"sideBar",ref:g},null,8,["scenario"])]),_:1},8,["modelValue"])],32))}});const Ft={style:{height:"100vh"}},Lt=L({setup(e){return(t,s)=>(r(),d("div",Ft,[x(Et)]))}});De(Lt).mount("#app");
